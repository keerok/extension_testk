//! BuildVersion: @@BUILD_NUMBER-@@SHORT_SHA
//! ContentScriptVersion: @@CONTENT_SCRIPT_VERSION
var Okta={fn:{},Page:{},Config:{},Modal:{Mixins:{},Views:{}},loc:{strings:{}}};Okta.window=this;var ENV={getCss:function(n){return this._domain+"/plugin/css/"+n},getImg:function(n){return this._domain+"/plugin/img/"+n},DefaultTimeout:25e3,DefaultWaitDelay:250};Okta.Config={enabledLogging:!1,allowOktaHttp:!1,useLocalJS:!1,verifyContentScript:!0,buildType:"prodBuild",startrecordingLogs:!1,onboardingLaunchNewTab:!0},Okta.WindowUtil=function(e){var n={};return e&&(n.setTimeout=function(n,t){return e.setTimeout(n,t)},n.setInterval=function(n,t){return e.setInterval(n,t)}),n}(Okta.window);var _okta={debounce:function(t,e,o){var i,a,r,s,u,c=function(){if(Okta){var n=Date.now()-s;n<e&&0<=n?i=Okta.WindowUtil.setTimeout(c,e-n):(i=null,o||(u=t.apply(r,a),i||(r=a=null)))}};return function(){if(Okta){r=this,a=arguments,s=Date.now();var n=o&&!i;return i=i||Okta.WindowUtil.setTimeout(c,e),n&&(u=t.apply(r,a),r=a=null),u}}}},Log=function(n){function t(){}if(!n)return{debug:t,info:t,warn:t,error:t};if("undefined"!=typeof window){var e=["debug","info","warn","error"];window.console||(window.console={}),window.console.log||(window.console.log=t);for(var o=0;o<e.length;++o)window.console[e[o]]||(window.console[e[o]]=window.console.log)}function i(n){return n?function(){arguments.length&&(arguments[0]="Preload script: "+arguments[0]),n.apply(console,arguments)}:t}return{debug:i(console.debug),info:i(console.log),warn:i(console.warn),error:i(console.error)}}(Okta.Config.enabledLogging);!function(){var n=Okta.fn.url={},i=["cloudareanet.com","clouditude.com","hioktane.com","lowoktane.com","openalloy.com","okta.com","okta1.com","okta-emea.com","oktapreview.com","perfcloud.org","primeapp.com","trexcloud.com","widerock.com","okta.ninja"],e=["/app/UserHome","/plugin/bookmark","/home/plugin","/enduser/app-settings"];function o(n,t){return n===t||0===n.indexOf(t+"/")}n.isOktaPage=function(n){var t=function o(n){if(n){var t=n.split(".");if(!(t.length<2))return t[t.length-2]+"."+t[t.length-1]}}(n);if(!t)return!1;for(var e=0;e<i.length;++e)if(i[e]===t)return!0;return!1},n.isCustomDomain=function(n,t){if(!t)return!1;var e=n.protocol+"//"+n.hostname;return t===e||0===t.indexOf(e+":")},n.isPotentialCustomDomain=function(n){for(var t=0;t<e.length;++t)if(o(n,e[t]))return!0;return o(n,"/plugin/servePopover")}}(),function(){var i=Okta.fn.checks={};i.chainChecks=function(t,e){if(t&&t.length){var o=t.shift();o.fn&&o.fn(function(n){if(n)return Log.info(o.name+" - starting content script."),void(e&&e());Log.info(o.name+" - skipped."),i.chainChecks(t,e)})}},i.checkMessage=function(n,e,o){return function(t){n.postMessage(e,function(n){t&&t(o(n))})}},i.checkFunction=function(t){return function(n){n&&n(t())}}}(),function(){var t=Okta.fn.dom={},u=_okta.debounce;t.getTimedNotification=function(){var t={},e=0;return t.startMonitoring=function(n){e&&t.stopMonitoring(),e=setInterval(n,2e3)},t.stopMonitoring=function(){e&&(clearInterval(e),e=0)},t},t.getMutationObserver=function(t){var e={},o={attributes:!0,childList:!0,subtree:!0,attributeFilter:["class","style"],attributeOldValue:!1,characterDataOldValue:!1},i=new MutationObserver(function s(){if(!e.onChange)return;if(1e4<Date.now()-a)return void r();n()}),a=0,n=u(r,1e3);function r(){e.onChange&&e.onChange(),a=Date.now()}return e.startMonitoring=function(n){e.onChange=n,i.observe(t,o),a=Date.now()},e.stopMonitoring=function(){i.disconnect(),e.onChange=null},e},t.getDomObserver=function(n){return"function"==typeof window.MutationObserver?t.getMutationObserver(n):t.getTimedNotification()}}(),function(){var e=Okta.fn.scan={},a=/^password$/i;function t(n,t){var e,o=n.getElementsByTagName(t);if(20<o.length)return Log.info("Too many inputs. Assuming there is a password tag."),!0;for(var i=0;i<o.length;++i)if("password"===(e=o[i]).getAttribute("type")||a.test(e.getAttribute("id"))||a.test(e.getAttribute("placeholder")))return!0;return!1}e.onDomUpdate=function(n,t){e.searchPasswordField(document)&&(n.stopMonitoring(),t(!0))},e.searchPasswordField=function(n){return 25<n.forms.length?(Log.info("Too many forms. Assuming there is a password tag."),!0):t(n,"input")||t(n,"textarea")},e.startObserver=function(n,t){Log.info("Starting observer"),n.startMonitoring(function(){e.onDomUpdate(n,t)}),e.onDomUpdate(n,t)}}(),Okta.Port=function(n){if(!n.runtime)throw new Error("Failed to initialize port. No runtime property found on WebExtension object.");var t={},e={},o=n.runtime.connect();return o.onMessage.addListener(function(n){n.id&&"undefined"!==e[n.id]||Log.info("Unknown message: "+JSON.stringify(n)),e[n.id]&&e[n.id](n),delete e[n.id]}),t.postMessage=function(n,t){e[n.id]=t||null,o.postMessage(n)},t.disconnect=function(){o.disconnect()},t},function StartContentScriptIIFE(){Log.info(window.location.href);var n=Okta.Port(chrome),t=Okta.fn.url.isOktaPage,e=Okta.fn.url.isCustomDomain,o=Okta.fn.url.isPotentialCustomDomain,i=Okta.fn.scan.startObserver,a=Okta.fn.dom.getDomObserver,r=Okta.fn.checks.chainChecks,s=Okta.fn.checks.checkMessage,u=Okta.fn.checks.checkFunction,c=!1;function f(n){return!!n.data&&!!JSON.parse(n.data).val}r([{name:"Okta page",fn:u(function(){return t(window.location.hostname)})},{name:"Potential custom page",fn:u(function(){return o(window.location.pathname)})},{name:"Save password",fn:s(n,{type:"getSessionTabState",id:"savePassword",data:{key:"PROMPT_SAVE_PASSWORD"}},f)},{name:"Site flow",fn:s(n,{type:"getSessionTabState",id:"siteFlow",data:{key:"CURRENT_FLOW"}},f)},{name:"Self service site",fn:s(n,{type:"getSessionTabState",id:"selfServiceSite",data:{key:"CURRENT_SELF_SERVICE_APP_CREDENTIALS"}},f)},{name:"Custom okta page",fn:s(n,{type:"getPersistentState",id:"domains",data:{key:"DOMAINS"}},function d(n){if(n.data){var t=JSON.parse(n.data).val;return t&&e(window.location,t.customDomain)}})},{name:"Dom observer",fn:function(n){i(a(document),n)}}],function l(){c||(c=!0,Okta=undefined,_okta=undefined,n.postMessage({type:"injectContentScript",id:"inject"},function(){n.disconnect()}),Log.info("<--------------------------------------------------------\x3e"))})}();