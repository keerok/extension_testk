Okta.SuppressPwdSave=function(){var o={},t=Okta.Q,r=2e3,e=Okta.fn.storage.wrapVal,s=0,n=0,i={},a=Okta.fn.bg.chromeP;function u(){++n;Log.info("Saving password is turned off temporarily. Restore requests: "+n);setTimeout(function(){--n;o.restoreSavePassword()},r)}o.restoreSavePassword=function(){if(!chrome.privacy||!chrome.privacy.services){Log.info("Plugin doesn't have privacy permissions");return t()}if(n!=0){Log.info("Restore postponed by SSO. Shared count: "+n);return t()}if(i[s]){Log.info("Restore postponed by tab "+s);return t()}return a.privacy.services.passwordSavingEnabled.get({}).then(function(r){if(r.levelOfControl==="controlled_by_this_extension"){Log.info("Reset password to user defaults.");chrome.privacy.services.passwordSavingEnabled.clear({})}})};o.turnOffSuppressPassword=function(){return a.privacy.services.passwordSavingEnabled.get({}).then(function(r){if(!r.value){Log.info("Saving password is already turned off.")}if(r.levelOfControl!=="controllable_by_this_extension"&&r.levelOfControl!=="controlled_by_this_extension"){Log.error("Plugin has no access to password saving: "+r.levelOfControl);return false}return a.privacy.services.passwordSavingEnabled.set({value:false}).then(function(){if(!!chrome.runtime.lastError){Log.error("Failed to turn off pwd manager: "+chrome.runtime.lastError);return false}return true})})};o.turnOffByTab=function(r){Log.info("Saving password is turned off by tab "+r+", will restore later");o.setSuppressTab(r);if(r!=s){return t()}return o.turnOffSuppressPassword()};o.turnOffBySSO=function(){return o.turnOffSuppressPassword().then(function(r){if(!r){return}Log.info("Saving password is turned off by SSO, will restore later");u()})};o.turnOffSavePasswordFeature=function(r,e){if(!chrome.privacy||!chrome.privacy.services){var n="Plugin doesn't have privacy permissions";Log.info(n);return t({errorCode:n})}var s=!!e&&!!e.byTab;return s?o.turnOffByTab(r):o.turnOffBySSO()};o.hasPrivacyPermissions=function(){if(!chrome.privacy||!chrome.privacy.services){return t(e(false))}return a.permissions.contains({permissions:["privacy"]}).then(function(r){return e(!!r)})};o.setSuppressTab=function(r){i[r]=true};o.deleteSuppressTab=function(r,e){var n=false;if(r===s){if(!e){s=0}n=true}if(!i[r]){return}delete i[r];n&&o.restoreSavePassword()};o.checkSuppressTabOnActivate=function(r){var e=!!i[s];var n=!!i[r];s=r;if(e===n){return}i[r]?o.turnOffSavePasswordFeature(r,{byTab:true}):o.restoreSavePassword()};o.checkSuppressTabOnWindowFocusChange=function(r){if(r===chrome.windows.WINDOW_ID_NONE){return}chrome.tabs.query({active:true,windowId:chrome.windows.WINDOW_ID_CURRENT},function(r){if(r.length>0){o.checkSuppressTabOnActivate(r[0].id)}})};o.getPasswordSavingDetails=function(){if(!chrome.privacy||!chrome.privacy.services){return t({levelOfControl:"does_not_have_privacy_permissions"})}return a.privacy.services.passwordSavingEnabled.get({})};return o};